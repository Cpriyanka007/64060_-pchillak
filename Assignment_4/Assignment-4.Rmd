---
title: "Assignment 4"
author: "Priyanka Chillakuru"
date: "3/20/2022"
output: pdf_document
---

```{r setup }

Pharmaceuticals <- read.csv("C:/Users/cpriy/Downloads/Pharmaceuticals (1).csv")

#Reading the required libraries

library(tidyverse)# Data manipulation
library(factoextra)# Used for clustering algorithms and visualization
library(dplyr)
library(ggplot2)
library(cluster)

#Tas1-kUse only the numerical variables (1 to 9) to cluster the 21 firms.
#Justify the various choices made in
#conducting the cluster analysis, such as weights for different variables, 
#the specific clustering algorithm(s)
#used, the number of clusters formed, and so on.

#Prior to clustering data, remove the missing data and rescale variables for comparability.

Pharma_data <- na.omit(Pharmaceuticals) #Provides the data after removing the incomplete cases.
Pharma_data

#Taking the quantitative variables(1-9) to cluster the 21 firms

row.names(Pharma_data)<- Pharma_data[,1]
Pharma_data1<- Pharma_data[,3:11]# Considering only numercial values i.e., 3-11 columns from csv file
head(Pharma_data1)

#Normalizing the data frame with scale method

Pharma_data2<-scale(Pharma_data1)
head(Pharma_data2)

#To determine the number of clusters to do the cluster analysis using Elbow Method

fviz_nbclust(Pharma_data2, kmeans, method = "wss") 

##By seeing the above graph from Elbow method, Graph is not clear to choose k=2 or 3 or 4 or 5.

#Silhouette method for determining no of clusters

fviz_nbclust(Pharma_data2, kmeans, method = "silhouette")

##By seeing the graph from silhouette method, I can see sharp rise at k=5. 
#So, considering the  silhouette method.



#Applying K-means 

set.seed(64060)
k_5<- kmeans(Pharma_data2,centers=5,nstart = 25)

#Visualizing the output
#centroids

k_5$centers
fviz_cluster(k_5,data = Pharma_data2) # to Visualize the clusters
k_5
distance<- dist(Pharma_data2, method = "euclidean")
fviz_dist(distance)

## I can see there are 5 clusters and the center is defined after 25 restarts 
#which is determined in kmeans.


#K-Means Cluster Analysis- Fit the data with 5 clusters

fit<-kmeans(Pharma_data2,5)


#Finding the mean value of all quantitative variables for each cluster

aggregate(Pharma_data2,by=list(fit$cluster),FUN=mean)

Pharma_data3<-data.frame(Pharma_data2,fit$cluster)
Pharma_data3
View(Pharma_data3)

#To view the cluster plot

clusplot(Pharma_data2,fit$cluster,color = TRUE,shade = TRUE,labels = 2,lines = 0)

#Task 2 Interpret the clusters with respect to the numerical variables used in forming the clusters.

#By noticing the mean values of all quantitative variables for each cluster

#Cluster_1 - AGN , PHA , BAY

#Cluster_2 - JNJ , MRK , GSK , PFE

#Cluster_3 - AHM , AVE , WPI

#Cluster_4 - IVX , MRX , ELN , CHTT

#Cluster_5 - ABT , NVS , AZN , LLY , BMY , WYE , SGP

##Cluster 1 has highest PE_Ratio and lowest Leverage, Asset_Turnover.
##Cluster 2 has highest Market_Cap,ROA,ROE,Asset_Turnover and lowest is Beta,PE_Ratio.
##Cluster 3 has highest Rev_Growth and lowest PE_Ratio, Asset_Turnover. 
##Cluster 4 has highest Beta, Rev_Growth  and lowest Market_Cap, ROE, ROA, 
#Leverage, Net_Profit_Margin.

##Cluster 5 has highest Net_Profit_Margin and lowest leverage,Beta.

#Task-3. 

#Is there a pattern in the clusters with respect to the numerical variables (10 to 12)? 
#(those not used in forming the clusters)

#With respect to the Media recommendation variable, there is a pattern in the clusters.

#Cluster 1 with highest PE_Ratio has Hold Recommendation.
#Cluster 2 with highest Market_Cap, highest ROE, highest ROA, highest Asset_Turnover has equal Hold 
#and Moderate Buy Recommendation.
#Cluster 3 with lowest PE_Ratio and lowest Asset_Turnover has Hold Recommendation.
#Cluster-4 with highest Beta, highest Leverage has mostly Moderate Buy Recommendation.
#Cluster 5 with highest Net_Profit_Margin has mostly Hold Recommendation.

##In terms of variables, I have seen a pattern among the clusters (10 to 12).
#Clusters 1,2,4,5 has Hold Recommendation and Clusters 1,3 has mostly Moderate Buy Recommendation


#Task-4

# Provide an appropriate name for each cluster using any or all of the variables in the data set.

#Cluster-1 - Hold Cluster or Moderate Buy Cluster.

#Cluster-2 - Low Asset_Turnover,PE_Ratio cluster (or) Hold cluster.

#Cluster-3 - High Leverage cluster, Beta (or) Buy Cluster.

#Cluster-4 - High PE_Ratio cluster (or) High Hold cluster.

#Cluster-5 - High Net_Profit_Margin cluster (or) High Hold cluster.



```

